# .github/workflows/build-tailwind.yml

name: Build and Commit Tailwind CSS

on:
  push:
    branches:
      - main # This workflow runs when changes are pushed to the main branch

permissions:
  contents: write # Grant permission to write to the repository for committing changes

jobs:
  build:
    runs-on: ubuntu-latest # Run the job on an Ubuntu virtual machine

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4 # Action to checkout your repository code

      - name: Set up Node.js
        uses: actions/setup-node@v4 # Action to set up Node.js environment
        with:
          node-version: '20' # Specify Node.js version 20

      - name: Install Dependencies
        run: npm install # Install project dependencies (e.g., Tailwind CSS, Autoprefixer)

      - name: Create dist directory
        run: mkdir -p dist # Ensure the 'dist' directory exists

      - name: Build Tailwind CSS
        run: npm run build # Run the Tailwind CSS build command defined in package.json

      - name: Verify Build Output
        run: ls -R # List contents of the repository to confirm 'dist/output.css' is generated

      - name: Commit generated CSS
        uses: stefanzweifel/git-auto-commit-action@v5 # Action to automatically commit changes
        with:
          commit_message: "chore: Rebuild Tailwind CSS" # Commit message for the auto-commit
          file_pattern: "dist/output.css" # Specify the file to be committed
          add_options: '-f' # Force add the file, even if ignored by .gitignore
